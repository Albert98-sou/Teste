name: UE5-Gamer-PC

on:
  workflow_dispatch:

jobs:
  ue5-machine:
    runs-on: windows-2022
    timeout-minutes: 360

    steps:

    # =============================
    # UPDATE SYSTEM
    # =============================
    - name: Update Windows
      run: |
        powershell -Command "Install-WindowsUpdate -AcceptAll -IgnoreReboot"
      shell: powershell

    # =============================
    # INSTALL CHOCOLATEY
    # =============================
    - name: Install Chocolatey
      run: |
        Set-ExecutionPolicy Bypass -Scope Process -Force;
        [System.Net.ServicePointManager]::SecurityProtocol = 3072;
        iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
      shell: powershell

    # =============================
    # INSTALL REQUIRED PROGRAMS
    # =============================
    - name: Install Essentials
      run: |
        choco install googlechrome -y
        choco install 7zip -y
        choco install visualstudio2022buildtools -y
        choco install vcredist-all -y
      shell: powershell

    # =============================
    # INSTALL NVIDIA DRIVER (SIMULADO)
    # =============================
    - name: NVIDIA Setup
      run: |
        echo "Configuring NVIDIA GPU environment..."
      shell: powershell

    # =============================
    # ENABLE DIRECTX 12
    # =============================
    - name: Enable DirectX
      run: |
        dxdiag
      shell: powershell

    # =============================
    # INSTALL EPIC GAMES LAUNCHER
    # =============================
    - name: Install Epic Games Launcher
      run: |
        choco install epicgameslauncher -y
      shell: powershell

    # =============================
    # KEEP VM RUNNING
    # =============================
    - name: Keep Alive
      run: |
        Start-Sleep -Seconds 21600
      shell: powershell
